@page
@model WahoClient.Pages.WarehouseStaff.Products.IndexModel
@{
    ViewData["Title"] = "Index";
    var successMessage = TempData["successMessage"] as string;
    var message = TempData["message"] as string;
}


<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Waho - Sản Phẩm</title>
    <link href="~/css/modal.css" rel="stylesheet" asp-append-version="true" />
</head>
<body style="background: #f2f2f2">
    @*insert model*@
    <div class="modal">
        <div id="insert-modal">
            <form id="insertForm" asp-page="./Create" method="post">
                <div class="col-md-6">
                    <h4 class="text-right">Thêm sản phẩm mới</h4>
                    <div id="notification-insert"></div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6">
                        <label class="labels">Tên sản phẩm</label>
                        <input name="productName" id="insert-productName" class="form-control input" type="text" placeholder="Nhập tên sản phẩm" required />
                    </div>
                    <div class="col-md-6">
                        <label class="labels">Giá nhập</label>
                        <input name="importPrice" id="insert-importPrice" class="form-control input" type="number" min="1000" placeholder="Điền Giá nhập" required />
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6">
                        <label class="labels">Thương hiệu</label>
                        <input name="trademark" id="insert-trademark" type="text" class="form-control input" placeholder="Nhập tên thương hiệu" required />
                    </div>
                    <div class="col-md-6">
                        <label class="labels">Số lượng</label><br />
                        <input name="quantity" id="insert-quantity" type="number" min="1" class="form-control input" placeholder="Vị trí" required />
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6">
                        <label class="labels">Trọng lượng</label>
                        <input name="weight" id="insert-weight" type="number" min="1" class="form-control input" placeholder="Trọng lượng" required />
                    </div>
                    <div class="col-md-6">
                        <label class="labels">Vị trí</label>
                        <select name="location" id="insert-location" class="form-select input" aria-label="Default select example">
                            @foreach (var s in Model.locations)
                            {
                                <option value="@(s.LocationId)">@s.Name</option>
                            }
                        </select>
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6">
                        <label class="labels">Đơn vị</label>
                        <input name="unit" id="insert-unit" type="text" class="form-control input" placeholder="Đơn vị" required />
                    </div>
                    <div class="col-md-6">
                        <label class="labels">Đơn giá</label>
                        <input name="unitPrice" id="insert-unitPrice" type="number" min="1000" class="form-control input" placeholder="Đơn giá" required />
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6">
                        <label class="labels">Định mức tồn min</label>
                        <input name="inventoryLevelMin" id="insert-inventoryLevelMin" type="number" min="1" class="form-control input" placeholder="Định mức tồn min" required />
                    </div>
                    <div class="col-md-6">
                        <label class="labels">Định mức tồn max</label>
                        <input name="inventoryLevelMax" id="insert-inventoryLevelMax" type="number" min="1" class="form-control input" placeholder="Định mức tồn max" required />
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6">
                        <label class="labels">Miêu tả</label>
                        <input name="description" id="insert-description" type="text" class="form-control input" placeholder="nhập Miêu tả" />
                    </div>
                    <div class="col-md-6">
                        <label class="labels">Loại sản phẩm</label>
                        <select name="subCategory" id="insert-subCategory" class="form-select input" aria-label="Default select example">
                            @foreach (var s in Model.subCategories)
                            {
                                <option value="@(s.SubCategoryId)">@s.SubCategoryName</option>
                            }
                        </select>
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6">
                        <label class="labels">Nhà cung cấp</label>
                        <select name="supplierID" id="insert-supplierID" class="form-select input" aria-label="Default select example">
                            @foreach (var s in Model.suppliers)
                            {
                                <option value="@(s.SupplierId)">@s.CompanyName</option>
                            }
                        </select>
                    </div>
                    <div class="col-md-6">
                        <label class="labels">Sản phẩm có hạn sử dụng</label>
                        <div class="form-check">
                            <input id="checkBoxDate" onclick="showInsertDate()" class="col-1 form-check-input" style="width:20px; height:20px" type="checkbox" />
                            <label class="form-check-label">Sản phẩm có hạn sử dụng</label>
                        </div>
                    </div>
                </div>
                <div class="row mt-2 insertDate" style="display:none" id="insertDate">
                    <div class="col-md-6">
                        <label class="labels">ngày sản xuất</label>
                        <input name="dateOfManufacture" id="dateOfManufactureInput" type="date" class="form-control input" />
                    </div>
                    <div class="col-md-6">
                        <label class="labels">Ngày hết hạn</label>
                        <input name="expiry" id="expiryInput" type="date" class="form-control input" />
                    </div>
                </div>
                <div class="text-center mt-5">
                    <button id="btnSubmit" class="btn btn-primary" type="submit" >Thêm sản phẩm</button>
                    <button class="btn btn-outline-primary" type="button" onclick="modal('insert-modal', 0, 'scale(0)')">Đóng</button>
                </div>
            </form>
        </div>
    </div>
    @*end insert model*@
    @*More model*@
    <div class="modal">
        <div class="row" id="more-modal">
            <div class="col-lg-4">
                <div class="form-check d-flex">
                    <input type="checkbox" value="Tên sản phẩm" checked id="productName" onclick="showProperty('tbProductName')" class="form-check-input" style="width:20px; height:20px; margin-left:10px; margin-right:10px;border:1px solid #FF9966" />
                    <label class="form-check-label">Tên sản phẩm</label>
                </div>
                <div class="form-check d-flex">
                    <input type="checkbox" value="Giá nhập" checked id="importPrice" onclick="showProperty('tbImportPrice')" class="form-check-input" style="width:20px; height:20px; margin-left:10px; margin-right:10px;border:1px solid #FF9966" />
                    <label class="form-check-label">Giá nhập</label>
                </div>
                <div class="form-check d-flex">
                    <input type="checkbox" value="Đơn giá" checked id="unitPrice" onclick="showProperty('tbUnitPrice')" class="form-check-input" style="width:20px; height:20px; margin-left:10px; margin-right:10px;border:1px solid #FF9966" />
                    <label class="form-check-label">Đơn giá</label>
                </div>
            </div>

            <div class="col-lg-4">
                <div class="form-check d-flex">
                    <input type="checkbox" value="Thương hiệu" id="trademark" onclick="showProperty('tbTrademark')" class="form-check-input" style="width:20px; height:20px; margin-left:10px; margin-right:10px;border:1px solid #FF9966" />
                    <label class="form-check-label">Thương hiệu</label>
                </div>
                <div class="form-check d-flex">
                    <input type="checkbox" value="Trọng lượng" id="weight" onclick="showProperty('tbWeight')" class="form-check-input" style="width:20px; height:20px; margin-left:10px; margin-right:10px;border:1px solid #FF9966" />
                    <label class="form-check-label">Trọng lượng</label>
                </div>
                <div class="form-check d-flex">
                    <input type="checkbox" value="Vị trí" id="location" checked onclick="showProperty('tbLocation')" class="form-check-input" style="width:20px; height:20px; margin-left:10px; margin-right:10px;border:1px solid #FF9966" />
                    <label class="form-check-label">Vị trí</label>
                </div>
                <div class="form-check d-flex">
                    <input type="checkbox" value="Đơn vị" id="unit" onclick="showProperty('tbUnit')" class="form-check-input" style="width:20px; height:20px; margin-left:10px; margin-right:10px;border:1px solid #FF9966" />
                    <label class="form-check-label">Đơn vị</label>
                </div>
            </div>

            <div class="col-lg-4">
                <div class="form-check d-flex">
                    <input type="checkbox" value="Định Mức tồn Min" id="inventoryLevelMin" onclick="showProperty('tbInventoryLevelMin')" class="form-check-input" style="width:20px; height:20px; margin-left:10px; margin-right:10px;border:1px solid #FF9966" />
                    <label class="form-check-label">Định Mức tồn Min</label>
                </div>
                <div class="form-check d-flex">
                    <input type="checkbox" value="Định Mức tồn Max" id="inventoryLevelMax" onclick="showProperty('tbInventoryLevelMax')" class="form-check-input" style="width:20px; height:20px; margin-left:10px; margin-right:10px;border:1px solid #FF9966" />
                    <label class="form-check-label">Định Mức tồn Max</label>
                </div>
                <div class="form-check d-flex">
                    <input type="checkbox" value="Mô tả" id="description" onclick="showProperty('tbDescription')" class="form-check-input" style="width:20px; height:20px; margin-left:10px; margin-right:10px;border:1px solid #FF9966" />
                    <label class="form-check-label">Mô tả</label>
                </div>
                <div class="form-check d-flex">
                    <input type="checkbox" value="Số lượng" checked id="description" onclick="showProperty('tbQuantity')" class="form-check-input" style="width:20px; height:20px; margin-left:10px; margin-right:10px;border:1px solid #FF9966" />
                    <label class="form-check-label">Số lượng</label>
                </div>
            </div>
            <div class="text-center mt-5">
                <button class="btn btn-outline-primary" type="button" onclick="modal('more-modal', 1, 'scale(0)')">Đóng</button>
            </div>
        </div>
    </div>
    @*end more model*@
    @*update model*@
    <div class="modal">
        <div id="update-modal">
            <form id="insertForm" asp-page="./Edit" method="post">
                <div class="col-md-6">
                    <h4 class="text-right">Chi tiết sản phẩm</h4>
                    <div id="notification"></div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6">
                        <label class="labels">Tên sản phẩm</label>
                        <input name="productNameUpdate" id="productNameUpdate" class="form-control input" type="text" placeholder="Nhập tên sản phẩm" required />
                        <input name="productIDUpdate" id="productIDUpdate" type="hidden" />
                    </div>
                    <div class="col-md-6">
                        <label class="labels">Giá nhập</label>
                        <input name="importPriceUpdate" id="importPriceUpdate" class="form-control input" type="number" min="1000" placeholder="Điền Giá nhập" required />
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6">
                        <label class="labels">Thương hiệu</label>
                        <input name="trademarkUpdate" id="trademarkUpdate" type="text" class="form-control input" placeholder="Nhập tên thương hiệu" required />
                    </div>
                    <div class="col-md-6">
                        <label class="labels">Số lượng</label><br />
                        <input name="quantityUpdate" id="quantityUpdate" type="number" min="1" class="form-control input" placeholder="Vị trí" required />
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6">
                        <label class="labels">Trọng lượng</label>
                        <input name="weightUpdate" id="weightUpdate" type="number" min="1" class="form-control input" placeholder="Trọng lượng" />
                    </div>
                    <div class="col-md-6">
                        <label class="labels">Vị trí</label>
                        <select name="locationUpdate" id="locationUpdate" class="form-select input" aria-label="Default select example">
                            @foreach (var s in Model.locations)
                            {
                                <option value="@(s.LocationId)">@s.Name</option>
                            }
                        </select>
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6">
                        <label class="labels">Đơn vị</label>
                        <input name="unitUpdate" id="unitUpdate" type="text" class="form-control input" placeholder="Đơn vị" required />
                    </div>
                    <div class="col-md-6">
                        <label class="labels">Đơn giá</label>
                        <input name="unitPriceUpdate" id="unitPriceUpdate" type="number" min="1000" class="form-control input" placeholder="Đơn giá" required />
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6">
                        <label class="labels">Định mức tồn min</label>
                        <input name="inventoryLevelMinUpdate" id="inventoryLevelMinUpdate" type="number" min="1" class="form-control input" placeholder="Định mức tồn min" required />
                    </div>
                    <div class="col-md-6">
                        <label class="labels">Định mức tồn max</label>
                        <input name="inventoryLevelMaxUpdate" id="inventoryLevelMaxUpdate" type="number" min="1" class="form-control input" placeholder="Định mức tồn max" required />
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6">
                        <label class="labels">Miêu tả</label>
                        <input name="descriptionUpdate" id="descriptionUpdate" type="text" class="form-control input" placeholder="nhập Miêu tả" />
                    </div>
                    <div class="col-md-6">
                        <label class="labels">Loại sản phẩm</label>
                        <select name="subCategoryUpdate" id="subCategoryUpdate" class="form-select input" aria-label="Default select example">
                            @foreach (var s in Model.subCategories)
                            {
                                <option value="@(s.SubCategoryId)">@s.SubCategoryName</option>
                            }
                        </select>
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6">
                        <label class="labels">Nhà cung cấp</label>
                        <select name="supplierIDUpdate" id="supplierIDUpdate" class="form-select input" aria-label="Default select example">
                            @foreach (var s in Model.suppliers)
                            {
                                <option value="@(s.SupplierId)">@s.CompanyName</option>
                            }
                        </select>
                    </div>
                    <div class="col-md-6">
                        <label class="labels">Sản phẩm có hạn sử dụng</label>
                        <div class="form-check">
                            <input id="checkBoxDateUpdate" name="checkBoxDateUpdate" onclick="showInsertDate()" class="col-1 form-check-input" style="width:20px; height:20px" type="checkbox" />
                            <label class="form-check-label">Sản phẩm có hạn sử dụng</label>
                        </div>
                    </div>
                </div>
                <div class="row mt-2 insertDate" style="display:none" id="insertDate">
                    <div class="col-md-6">
                        <label class="labels">ngày sản xuất</label>
                        <input name="dateOfManufactureUpdate" id="dateOfManufactureUpdate" type="date" class="form-control input" />
                    </div>
                    <div class="col-md-6">
                        <label class="labels">Ngày hết hạn</label>
                        <input name="expiryUpdate" id="expiryUpdate" type="date" class="form-control input" />
                    </div>
                </div>
                <div class="text-center mt-5">
                    <button id="btnSubmit" class="btn btn-primary" type="submit">Lưu</button>
                    @*<button id="btnSubmit" class="btn btn-primary" type="button" onclick="DeleteProduct()">Xóa</button>*@
                    <button class="btn btn-outline-primary" type="button" onclick="modal('update-modal', 2, 'scale(0)')">Đóng</button>
                </div>
            </form>
        </div>
    </div>
    @*end update model*@
    @*upload model*@
    <div class="modal">
        <div id="upload-products-modal">
            <form id="insertForm" asp-page="./UploadFileExcel" method="post">
                <div class="col-md-6">
                    <h4 class="text-right">Tải lên danh file danh sách sản phẩm</h4>
                    <div id="notification"></div>
                </div>
                <div class="form-group">
                    <label for="excel-file">Excel File:</label>
                    <input type="file" name="ExcelFile" class="form-control-file" id="excel-file">
                </div>
                <a asp-page="./UploadFileExcel">Tải về file Excel mẫu</a>
                <div class="text-center mt-5">
                    <button id="btnSubmit" class="btn btn-primary" type="submit">Tải lên</button>
                    <button class="btn btn-outline-primary" type="button" onclick="modal('upload-products-modal', 3, 'scale(0)')">Đóng</button>
                </div>
            </form>
        </div>
    </div>
    @*end upload model*@
    @*start filter*@
    <div class="bg-waho-white">
        <div class="modal-confirmation" id="modal-confirmation"></div>
        <div class="mt-4 position-relative bodydiv">
            <form method="get" asp-page="./Index" asp-route-pageIndex="@Model.pageIndex" asp-route-pageSize="@Model.pageSize" asp-route-textSearch="@Model.textSearch"
                  asp-route-subCategory="@Model.subCategoryID" asp-route-location="@Model.locationId"
                  asp-route-priceFrom="@Model.priceFrom" asp-route-priceTo="@Model.priceTo"
                  asp-route-inventoryLevel="@Model.inventoryLevel" asp-route-supplierName="@Model.supplierName"
                  style="margin-bottom: 20px; ">
                <div class="d-flex">
                    <h3 class="col-2 me-4">Sản phẩm</h3>
                    @*search*@
                    <div class="form-group flex-grow-1 me-4">
                        <div class="input-group mb-3">
                            <input type="text" class="form-control" asp-for="textSearch" placeholder="Nhập tên sản phẩm, loại sản phẩm, tên nhà cung cấp" aria-label="Recipient's username" aria-describedby="basic-addon2">
                            <button class="input-group-text btn-primary" type="submit"><i class="bi bi-search"></i></button>
                        </div>
                    </div>
                    <div class="form-group me-4">
                        <button class="btn btn-primary" type="button" onclick="modal('insert-modal', 0, 'scale(1)');">
                            <i class="bi bi-plus-circle-fill" asp-page="Create"> </i>Thêm sản phẩm
                        </button>
                    </div>
                    <div class="form-group me-4">
                        <button class="btn btn-primary" type="button" onclick="modal('upload-products-modal', 3, 'scale(1)');">
                            <i class="bi bi-upload"></i> Upload Excel file
                        </button>
                    </div>
                    <div class="form-group me-4">
                        <button class="btn btn-primary" type="submit">
                            <a class="bi " style="text-decoration: none; color: white" asp-page="./ExportProducts">
                                Export Excel
                                <i class="bi bi-download"></i>
                            </a>
                        </button>
                    </div>
                    <div class="form-group me-4">
                        <button class="btn btn-primary" type="button" onclick="modal('more-modal', 1, 'scale(1)');">
                            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-list" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z" />
                            </svg>
                        </button>
                    </div>
                </div>

                @*end filter*@
                @if (TempData["message"] != null)
                {
                    <div id="error-alert" class="d-flex justify-content-end position-absolute toast-message">
                        <div class="alert alert-danger text-center"><h5>@TempData["message"]</h5></div>
                    </div>
                }
                @if (TempData["successMessage"] != null)
                {
                    <div id="success-alert" class="d-flex justify-content-end position-absolute toast-message">
                        <div class="alert alert-success text-center"><h5>@TempData["SuccessMessage"]</h5></div>
                    </div>
                }

                <div class="d-flex">
                    <div class="d-flex flex-column col-2 me-4">
                        <div class="form-group col-6 mx-auto mb-3">
                            <select id="inputState" class="form-select" asp-for="@Model.pageSize" onchange="this.form.submit()">
                                <option value="5"> 5 hàng</option>
                                <option value="10">10 hàng</option>
                                <option value="15">15 hàng</option>
                                <option value="20">20 hàng</option>
                            </select>
                        </div>
                        @*filer categories*@
                        <div class="row form-container py-4 mb-3">
                            <div class="m-auto" id="subcategory">
                                <div>
                                    <h6>Loại sản phẩm</h6>
                                    <hr />
                                </div>
                                <div class="form-check">
                                    @{
                                        int all = -1;
                                    }
                                    <input class="form-check-input" onclick="this.form.submit()" asp-checked="@Model.subCategoryID == @all" asp-for="@(Model.subCategoryID)" value="@all" type="radio" />
                                    <label class="form-check-label">
                                        Tất cả
                                    </label>
                                </div>
                                @foreach (var item in Model.subCategories)
                                {
                                    <div class="form-check">
                                        <input class="form-check-input" onclick="this.form.submit()" asp-checked="@Model.subCategoryID=='@item.SubCategoryId'" asp-for="@(Model.subCategoryID)" value="@item.SubCategoryId" type="radio" />
                                        <label class="form-check-label">
                                            @(item.SubCategoryName)
                                        </label>
                                    </div>
                                }
                            </div>
                        </div>
                        @*filter location*@
                        <div class="row form-container py-4 mb-3">
                            <div class="m-auto">
                                <div>
                                    <h6>Vị trí</h6>
                                    <hr />
                                </div>
                                <div class="form-check">
                                    @{
                                        int allLocation = -1;
                                    }
                                    <input class="form-check-input" onclick="this.form.submit()" asp-checked="@Model.locationId==@allLocation" asp-for="@(Model.locationId)" value="@allLocation" type="radio" />
                                    <label class="form-check-label">
                                        Tất cả
                                    </label>
                                </div>
                                @foreach (var item in Model.locations)
                                {
                                    <div class="form-check">
                                        <input class="form-check-input" onclick="this.form.submit()" asp-checked="@Model.locationId==@item.LocationId" asp-for="@(Model.locationId)" value="@item.LocationId" type="radio" />
                                        <label class="form-check-label">
                                            @(item.Name)
                                        </label>
                                    </div>
                                }
                            </div>
                        </div>
                        @*inventory level*@
                        <div class="row form-container py-4 mb-3">
                            <div class="m-auto">
                                <div>
                                    <h6>Định mức tồn</h6>
                                    <hr />
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" onclick="this.form.submit()" asp-checked="@Model.inventoryLevel=='all'" asp-for="@(Model.inventoryLevel)" value="all" type="radio" />
                                    <label class="form-check-label">
                                        Tất cả
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" onclick="this.form.submit()" asp-checked="@Model.inventoryLevel=='min'" asp-for="@(Model.inventoryLevel)" value="min" type="radio" />
                                    <label class="form-check-label">
                                        Nhỏ hơn định mức tồn
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" onclick="this.form.submit()" asp-checked="@Model.inventoryLevel=='max'" asp-for="@(Model.inventoryLevel)" value="max" type="radio" />
                                    <label class="form-check-label">
                                        Lớn hơn định mức tồn
                                    </label>
                                </div>
                            </div>
                        </div>
                        @*price range*@
                        <div class="row form-container py-4 mb-3">
                            <div class="m-auto">
                                <div>
                                    <h6>Khoảng giá</h6>
                                    <hr />
                                </div>
                                <div class="form-group">
                                    <label class="control-label">Từ</label>
                                    <div class="input-group">
                                        <span class="input-group-text span-input-primary" id="basic-addon1"><i class="bi bi-currency-dollar"></i></span>
                                        <input asp-for="@Model.priceFrom" type="number" class="form-control" id="priceFrom">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label">Đến</label>
                                    <div class="input-group">
                                        <span class="input-group-text span-input-primary" id="basic-addon1"><i class="bi bi-currency-dollar"></i></span>
                                        <input asp-for="@Model.priceTo" type="number" class="form-control" id="priceTo">
                                    </div>
                                </div>
                                <div class="text-center mt-4">
                                    <button class="btn btn-primary" type="submit">Lọc</button>
                                </div>
                            </div>
                        </div>
                        @*supplier*@
                        <div class="row form-container py-4 mb-3">
                            <div class="m-auto">
                                <div>
                                    <h6>Nhà cung cấp</h6>
                                    <hr />
                                </div>
                                <div class="form-group w-100 mx-auto mb-3">
                                    <select class="form-select" asp-for="@Model.supplierName" onchange="this.form.submit()">
                                        <option value="all">Tất cả</option>
                                        @foreach (var item in Model.suppliers)
                                        {
                                            <option value="@item.SupplierId.ToString()"> @(item.CompanyName)</option>
                                        }
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    @if (Model.TotalCount > 0)
                    {
                        <div class="flex-grow-1 form-container px-3">
                            <table class="table table-striped table-hover">
                                <thead>
                                    <tr>
                                        <th class="tbProductName">
                                            Tên sản phẩm
                                        </th>
                                        <th class="tbImportPrice">
                                            Giá nhập
                                        </th>
                                        <th class="tbUnitPrice">
                                            Đơn giá
                                        </th>
                                        <th style="display:none">
                                            @Html.DisplayNameFor(model => model.Products[0].HaveDate)
                                        </th>
                                        <th style="display:none">
                                            @Html.DisplayNameFor(model => model.Products[0].DateOfManufacture)
                                        </th>
                                        <th style="display:none">
                                            @Html.DisplayNameFor(model => model.Products[0].Expiry)
                                        </th>
                                        <th style="display:none" class="tbTrademark">
                                            Thương hiệu
                                        </th>
                                        <th style="display:none" class="tbWeight">
                                            Trọng lượng
                                        </th>
                                        <th class="tbLocation">
                                            Vị trí
                                        </th>
                                        <th class="tbQuantity">
                                            Số Lượng
                                        </th>
                                        <th style="display:none" class="tbUnit">
                                            Đơn vị
                                        </th>
                                        <th style="display:none" class="tbInventoryLevelMin">
                                            Định mức tồn min
                                        </th>
                                        <th style="display:none" class="tbInventoryLevelMax">
                                            Định mức tồn max
                                        </th>
                                        <th style="display:none" class="tbDescription">
                                            Miêu tả
                                        </th>
                                        <th class="tbSubCategory">
                                            Loại sản phẩm
                                        </th>
                                        <th>
                                            Nhà cung cấp
                                        </th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var item in Model.Products)
                                    {
                                        <tr>
                                            <td class="tbProductName">
                                                @Html.DisplayFor(modelItem => item.ProductName)
                                            </td>
                                            <td class="tbImportPrice">
                                                @Html.DisplayFor(modelItem => item.ImportPrice)
                                            </td>
                                            <td class="tbUnitPrice">
                                                @Html.DisplayFor(modelItem => item.UnitPrice)
                                            </td>
                                            <td style="display:none">
                                                @Html.DisplayFor(modelItem => item.HaveDate)
                                            </td>
                                            <td style="display:none">
                                                @Html.DisplayFor(modelItem => item.DateOfManufacture)
                                            </td>
                                            <td style="display:none">
                                                @Html.DisplayFor(modelItem => item.Expiry)
                                            </td>
                                            <td style="display:none" class="tbTrademark">
                                                @Html.DisplayFor(modelItem => item.Trademark)
                                            </td>
                                            <td style="display:none" class="tbWeight">
                                                @Html.DisplayFor(modelItem => item.Weight)
                                            </td>
                                            <td id="tbLocation">
                                                @Html.DisplayFor(modelItem => item.Location.Name)
                                            </td>
                                            <td id="tbQuantity">
                                                @Html.DisplayFor(modelItem => item.Quantity)
                                            </td>
                                            <td style="display:none" class="tbUnit">
                                                @Html.DisplayFor(modelItem => item.Unit)
                                            </td>
                                            <td style="display:none" class="tbInventoryLevelMin">
                                                @Html.DisplayFor(modelItem => item.InventoryLevelMin)
                                            </td>
                                            <td style="display:none" class="tbInventoryLevelMax">
                                                @Html.DisplayFor(modelItem => item.InventoryLevelMax)
                                            </td>
                                            <td style="display:none" class="tbDescription">
                                                @Html.DisplayFor(modelItem => item.Description)
                                            </td>
                                            <td class="tbSubCategory">
                                                @Html.DisplayFor(modelItem => item.SubCategory.SubCategoryName)
                                            </td>
                                            <td>
                                                @Html.DisplayFor(modelItem => item.Supplier.CompanyName)
                                            </td>
                                            <td class="d-flex align-items-center justify-content-between">
                                                <a onclick="getProductDetail(@(item.ProductId))">
                                                    <i class="bi bi-pencil-square icon-table icon-edit"></i>
                                                </a>
                                                <h6 class="m-0 vertical">|</h6>
                                                <a onclick="deleteProduct('@item.ProductId','@item.ProductName')">
                                                    <i class="bi bi-trash3-fill icon-table icon-delete"></i>
                                                </a>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                            <div class="d-flex mt-5">
                                <div class="pagination m-auto">
                                    <ul class="pagination">
                                        @if (Model.pageIndex > 1)
                                        {
                                            <li class="page-item">
                                                <a class="page-link link-paging" asp-page="./Index" asp-route-pageIndex="@(Model.pageIndex - 1)"
                                           asp-route-pageSize="@Model.pageSize" asp-route-textSearch="@Model.textSearch" asp-route-subCategory="@Model.subCategoryID"
                                           asp-route-location="@Model.locationId" asp-route-priceFrom="@Model.priceFrom" asp-route-priceTo="@Model.priceTo"
                                           asp-route-inventoryLevel="@Model.inventoryLevel" asp-route-supplierName="@Model.supplierName">Trước</a>
                                            </li>
                                        }
                                        @for (int i = 1; i <= Math.Ceiling(Model.TotalCount / (double)Model.pageSize); i++)
                                        {
                                            <li class="page-item @(Model.pageIndex == i ? "active" : "") link-active">
                                                <a class="page-link link-paging" asp-page="./Index"
                                           asp-route-pageIndex="@i" asp-route-pageSize="@Model.pageSize" asp-route-textSearch="@Model.textSearch" asp-route-subCategory="@Model.subCategoryID"
                                           asp-route-location="@Model.locationId" asp-route-priceFrom="@Model.priceFrom" asp-route-priceTo="@Model.priceTo"
                                           asp-route-inventoryLevel="@Model.inventoryLevel" asp-route-supplierName="@Model.supplierName">@i</a>
                                            </li>
                                        }
                                        @if (Model.pageIndex < Math.Ceiling(Model.TotalCount / (double)Model.pageSize))
                                        {
                                            <li class="page-item">
                                                <a class="page-link link-paging" asp-page="./Index" asp-route-pageIndex="@(Model.pageIndex + 1)"
                                           asp-route-pageSize="@Model.pageSize" asp-route-textSearch="@Model.textSearch" asp-route-subCategory="@Model.subCategoryID"
                                           asp-route-location="@Model.locationId" asp-route-priceFrom="@Model.priceFrom" asp-route-priceTo="@Model.priceTo"
                                           asp-route-inventoryLevel="@Model.inventoryLevel" asp-route-supplierName="@Model.supplierName">Sau</a>
                                            </li>
                                        }
                                    </ul>
                                </div>
                            </div>
                        </div>
                    }
                    else
                    {
                        <div class="flex-grow-1 d-flex align-items-center form-container">
                            <h5 class="m-auto">Không có sản phẩm nào phù hợp</h5>
                        </div>
                    }
                </div>
            </form>
        </div>
    </div>

    <script>

        function showProperty(id) {
            $('.' + id).toggle();
        }

        function showInsertDate() {
            if ($('.checkBoxDate').prop('checked')) {
                $('.checkBoxDate').prop('checked', false)
            } else {
                $('.checkBoxDate').prop('checked', true)
            }
            $('.insertDate').toggle();
        }


        // product details
        function getProductDetail(productID) {
            $.ajax({
                url: "https://localhost:7019/waho/Products/productId?productId=" + productID,
                type: "GET",
                data: { productId: productID },
                success: function (data) {
                    // Gán dữ liệu vào các trường của form
                    $("#productIDUpdate").val(productID)
                    $("#productNameUpdate").val(data.productName);
                    $("#importPriceUpdate").val(data.importPrice);
                    $("#trademarkUpdate").val(data.trademark);
                    $("#quantityUpdate").val(data.quantity)
                    $("#weightUpdate").val(data.weight);
                    $("#locationUpdate").val(data.locationId);
                    $("#unitUpdate").val(data.unit);
                    $("#unitPriceUpdate").val(data.unitPrice);
                    $("#inventoryLevelMinUpdate").val(data.inventoryLevelMin);
                    $("#inventoryLevelMaxUpdate").val(data.inventoryLevelMax);
                    $("#descriptionUpdate").val(data.description);
                    $("#subCategoryUpdate").val(data.subCategoryId);
                    $("#supplierIDUpdate").val(data.supplierId);
                    if (data.haveDate) {
                        $('#checkBoxDateUpdate').prop('checked', true);
                        $('.insertDate').show();
                        $("#expiryUpdate").val(formatDate(data.expiry));
                        $("#dateOfManufactureUpdate").val(formatDate(data.dateOfManufacture));
                    } else {
                        $('#checkBoxDate').prop('checked', false);
                    }
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    console.log(textStatus, errorThrown);
                },
                beforeSend: function (xhr) {
                    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');
                }
            });
            modal('update-modal', 2, 'scale(1)')
        }
        //format date
        function formatDate(date) {
            var d = new Date(date),
                month = '' + (d.getMonth() + 1),
                day = '' + d.getDate(),
                year = d.getFullYear();

            if (month.length < 2)
                month = '0' + month;
            if (day.length < 2)
                day = '0' + day;

            return [year, month, day].join('-');
        }

        function deleteProduct(id, name) {
            renderConfirmationModal(id, name)
            $('#modal-confirmation').css('display', 'flex')
        }

        function renderConfirmationModal(id, name) {
            $('#modal-confirmation').html(`
                                                                            <div class="modal-dialog ">
                                                                                <div class="modal-content modal-content-confirmation">
                                                                                    <div class=" modal-header p-1">
                                                                                        <h6 class="modal-title ms-3">
                                                                                            <i class="bi bi-exclamation-triangle-fill modal-confirm-content-title"></i>
                                                                                            Xác nhận muốn xoá sản phẩm này?
                                                                                        </h6>
                                                                                        <h5 class="toast__close mb-0" onclick="closeModalConfirmation()">
                                                                                            <i class="bi bi-x-lg"></i>
                                                                                        </h5>
                                                                                    </div>
                                                                                    <div class="modal-body">
                                                                                        <h6>Thông tin hoá đơn:</h6>
                                                                                        <p>Mã sản phẩm: ${id}</p>
                                                                                        <p>Tên sản phẩm: ${name}</p>
                                                                                    </div>
                                                                                    <div class="modal-footer p-1">
                                                                                        <button type="button" class="btn btn-primary" onclick="handleDelete('${id}')">Xác nhận</button>
                                                                                        <button type="button" onclick=" closeModalConfirmation()" class="btn btn-outline-primary"
                                                                                            data-bs-dismiss="modal">Đóng</button>
                                                                                    </div>
                                                                                </div>
                                                                            </div>`)
        }

        function handleDelete(id) {
            closeModalConfirmation()
            window.location.href = "Products/Delete?productID=" + id;
        }

        function closeModalConfirmation() {
            $('#modal-confirmation').css('display', 'none')
        }
        function checkInsert() {
            var productName = $("insert-productName").val();
            var importPrice = $("insert-importPrice").val();
            var trademark = $("insert-trademark").val();
            var quantity = $("insert-quantity").val();
            var weight = $("insert-weight").val();
            var unit = $("insert-unit").val();
            var unitPrice = $("insert-unitPrice").val();
            var inventoryLevelMin = $("insert-inventoryLevelMin").val();
            var inventoryLevelMax = $("insert-inventoryLevelMax").val();
            var description = $("insert-description").val();
            var check = true;
            console.log(productName);
            if (productName == "" || importPrice == "" || trademark == "" || quantity == "" || weight == "" || unit == "" || unitPrice == "" || inventoryLevelMin == "" || inventoryLevelMax == "" || description == "") {
                check = false;
                $("#notification-insert").html("hãy nhập đủ các trường");
                console.log("a");
            }
        }

        $(document).ready(function () {
            setTimeout(function () {
                $("#success-alert").fadeOut("slow", function () {
                    $(this).remove();
                });
                $("#error-alert").fadeOut("slow", function () {
                    $(this).remove();
                });
            }, 3000); // thời gian để tự động ẩn thông báo (tính bằng mili giây)
        });
    </script>
</body>
